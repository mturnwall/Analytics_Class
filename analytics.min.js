/**
 *  A javascript class that makes it real easy to add custom google analytics tracking to any web site.
 *  The goal of this class is to reduce the amount of custom javascript that needs to be written for custom google analytic tracking.
 *
 *  @author Michael Turnwall
 *
 *	@class  GA
 *
 *  @license Copyright (c) 2013 Michael Turnwall
 *  Released under the GPL v3 License
 *  <p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
 *  <p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
 *  <p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/gpl-3.0.html">&lt;http://www.gnu.org/licenses/gpl-3.0.html&gt;</a>.</p>
 */
var GA=function(){var t={domain:"",trackOutbound:!0,siteSearchSelector:"",siteSearchInput:"",timer:200},e={requestInfo:["_trackEvent","Request More Information","link"],siteSearch:["_trackEvent","Quick Search","main search"],printPage:["_trackEvent","Print","current page"],social:[["_trackSocial"],["_trackEvent","Social share"]]};return{version:"0.4.2",ready:!1,availableProviders:{},cleanValue:function(t){return t=t.replace(/^(\s)*/,""),t=t.replace(/(\s)*$/,"")},loadProviders:function(t){var e,i;for(e in t)try{i=this.availableProviders[e],i.setup(t[e])}catch(n){throw Error('Sorry, no provider with the name of "'+e+'" is available')}this.ready=!0},extend:function(){var t,e,i=arguments[0]||{},n=1,a=arguments.length;for(a===n&&(i=this,n=0);a>n;n++)if(e=arguments[n],null!==e)for(t in e)i[t]=e[t];return i},processFactoryOptions:function(t,e){var i,n,a=e;if(t)if("string"!=typeof t)for(i=0,n=t.length;n>i;i++)a.push(this.cleanValue(t[i])||"");else a.push(t);return a},factory:function(t,e){var i,n,a=!1;if(this.gaEvents[t]){a=[];for(i in this.gaEvents[t]){if(n=JSON.parse(JSON.stringify(this.gaEvents[t])),"string"==typeof this.gaEvents[t][i]){a.push(this.processFactoryOptions(e,n));break}a.push(this.processFactoryOptions(e,n[i]))}}return a},pushTrackEvent:function(t){var e;for(e in t)_gaq.push(t[e])},outboundLinks:function(t){var e=t.href,i=e.match(/maps.google.com/gi)?"Google Maps Driving Directions":"exit";GA.pushTrackEvent([["_trackEvent","Outbound Links",i,e]]),setTimeout(function(){location.href=e},this.opts.timer)},trackSiteSearch:function(t){return this.pushTrackEvent(this.factory("siteSearch",t[this.opts.siteSearchInput].value)),!0},trackForms:function(t){var e,i=t.getAttribute("data-analytics-type")||!1,n="";return i&&($("input, select",t).each(function(){e=this.getAttribute("type"),this.getAttribute("data-analytics-track-value")&&("text"===e||"hidden"===e?n+=":"+this.value:"radio"!==e&&"checkbox"!==e||!this.checked||(n+=":"+this.value))}),this.pushTrackEvent(this.factory(i,n.substr(1)))),!0},trackLinks:function(t){var e=RegExp("^http(s)?://([a-z]+\\.)?("+this.opts.domain+")","ig"),i=!1;if(this.analyticsType=t.getAttribute("data-analytics-type")||!1,this.analyticsType)i=[],this.analyticsInfo=t.getAttribute("data-analytics-info")?t.getAttribute("data-analytics-info").split(","):"",i=this.factory(this.analyticsType,this.analyticsInfo);else if(!e.test(t.href))return this.outboundLinks(t),!1;return i?(this.pushTrackEvent(i),!0):void 0},init:function(i,n){var a=this;this.gaEvents=this.extend(e,i),this.opts=this.extend(t,n),$("body").on("click","a",function(){return a.trackLinks(this)}),$("form").not(this.opts.siteSearchSelector).length&&$("form").not(this.opts.siteSearchSelector).on("submit",function(){return a.trackForms(this),!1}),$(this.opts.siteSearchSelector.length)&&$(this.opts.siteSearchSelector).submit(function(){return a.trackSiteSearch(this)})}}}();GA.availableProviders.Google={defaults:{domain:"",debug:!1,enhancedLink:!1,trackingId:""},setup:function(t){var e=window._gaq=window._gaq||[];if(options="string"!=typeof t?GA.extend({},this.defaults,t):GA.extend({},this.defaults,{trackingId:t}),scriptName=options.debug?"u/ga_debug.js":"ga.js",options.enhancedLink&&e.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]),!options.trackingId)throw Error("You need to provide a tracking ID for Google Analytics");e.push(["_setAccount",options.trackingId]),options.domain&&e.push(["_setDomainName",options.domain]),e.push(["_trackPageview"]),function(){var t,e;t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/"+scriptName,e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)}()}};